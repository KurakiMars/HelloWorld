<html>
    <head>
		<meta charset="utf-8" />
	    <script>
		    'use strict'; //在strict模式下运行的JavaScript代码，强制通过var申明变量，未使用var申明变量就使用的，将导致运行错误。
			var MYAPP = {};

			// 其他变量:
			MYAPP.name = 'myapp';
			MYAPP.version = 1.0;

			const PI = 3.14;
			//var a = 3;
			//var b = '3';
			//var nameZa = 'no way';
			/**************************************************************
			*由于JavaScript这个设计缺陷，不要使用==比较，始终坚持使用===比较。*
			**************************************************************/
			/*if(a==b)
			{
			    //第一种是==比较，它会自动转换数据类型再比较，很多时候，会得到非常诡异的结果；
			    alert('a==b');
			}
			if(a===b)
			{
			    //第二种是===比较，它不会自动转换数据类型，如果数据类型不一致，返回false，如果一致，再比较。
				alert(`a===b`); 
			}*/

           
			/*alert(`a=
			       ${a}
				   b=
				   ${b}`); 
			
			alert(`多行字符串?\n不是！${nameZa}`); 
            */

            //var strMessage = 'Hello World';
			//alert(strMessage);
			//alert(strMessage.toUpperCase());
			//alert(strMessage.toLowerCase());

            //Array
            var arrName = ["wf","ff","zz"]
		    //slice //数组的substring
            var arrCopy = arrName.slice(); //
            /* arrCopy.pop();
		    arrCopy.push("ab","ccd");
		    alert(arrCopy.pop()); //ccd
		    //arrCopy [wf,ff,ab]
		    arrCopy.unshift("11"); //arrCopy [11,wf,ff,ab]
		    arrCopy.sort(); //11,ab,ff,wf
		    arrCopy.shift();//ab,ff,wf
		    arrCopy.reverse();//wf,ff,ab
		    arrCopy.unshift("10010");  //10010,wf,ff,ab
		    //splice()方法是修改Array的“万能方法”，它可以从指定的索引开始删除若干元素，然后再从该位置添加若干元素：
		    arrCopy.splice(1,3,"App","ES6","10101"); //10010,App,ES6,10101
		    //alert(arrCopy.join('='));
            alert('for of');		
			for(var x of arrCopy)
			{
				alert(x);				
			}

			function count() {
				var arr = [];
				for (var i=1; i<=3; i++) {
					arr.push((function (n) {
						return function () {
							return n * n;
						}
					})(i));
				}
				return arr;
			}

			//练习：如何通过索引取到500这个值：
			var arr = [[1, 2, 3], [400, 500, 600], '-'];
			alert(arr[1][1]);

			arr.name = 'test';

			//for ... in循环将把name包括在内，但Array的length属性却不包括在内。
			alert('for in...');
			for(var x in arr)
			{
				alert(x);
			}

			//for ... of循环则完全修复了这些问题，它只循环集合本身的元素：
			alert('for of...');
			for(var x of arr)
			{
				alert(x);
			} */

			// //Map And Set
			// var a = ['A', 'B', 'C'];
			// var set = new Set(['sA','sB','sC']);
			// set.add('sD');

			// var map = new Map();
			// map.set('0','mA');
			// map.set('1','mB');
			// map.set('2','mC');
			// map.set('3','mD');


			// //iterable
			// a.forEach(function (element, index, array) {
			// 	// element: 指向当前元素的值
			// 	// index: 指向当前索引
			// 	// array: 指向Array对象本身
			// 	// alert('element');
			// 	// alert(element);
			// 	// alert('index');
			// 	// alert(index);
			// 	// alert('array');
			// 	// alert(array);
			// });

			// set.forEach(function(setValue)
			// {
			// 	alert('setValue='+setValue);
			// });

			// map.forEach(function(value,key){
			// 	alert('key='+key);
			// 	alert('value='+value);
			// });

			// var area = function (argWeight,argHeight)
			// {
			// 	var retArea = 0;
			// 	retArea = argWeight * argHeight;
			// 	return retArea;
			// };
			
			//由于JavaScript允许传入任意个参数而不影响调用，因此传入的参数比定义的参数多也没有问题，虽然函数内部并不需要这些参数：
			//alert('area='+area(2,3,3));

			//传入的参数比定义的少也没有问题：
			//alert('area='+area()); //返回NaN


			//arguments它只在函数内部起作用，并且永远指向当前函数的调用者传入的所有参数。
			// function foo(x) {
			// 	alert(x); // 10
			// 	for (var i=0; i<arguments.length; i++) {
			// 		alert(arguments[i]); // 10, 20, 30
			// 	}
			// }
			// foo(10, 20, 30);


			//rest
			/* function testRest(a,b,...rest)
			{
				alert('a = ' + a);
				alert('b = ' + b);
				alert('rest = '+rest);
			}
			testRest(1); */


			/* function sum(...rest) {
				var retSum = 0;
				// rest.forEach(function(value)
				// {
				// 	retSum+= value;
				// });
				for(let i of rest)
				{
					retSum += i;
				}
				return retSum;
			}

			alert(sum(1,2,3,4,5));

			///
			function area_of_circle(r, pi) {
				if(arguments.length<2)
				{
					pi = PI;
				}
				return pi*r*r;
			}
			 */
			
			//变量提升
			/*function foo() {
				var y = 'Bobi';
				var x = 'Hello, ' + y;
				alert(x);
			}
			foo(); */
			

			/* window.alert('调用window.alert()');
			// 把alert保存到另一个变量:
			var old_alert = window.alert;
			// 给alert赋一个新函数:
			window.alert = function () {};
			alert('无法用alert()显示了!');
			// 恢复alert:
			window.alert = old_alert;
			alert('又可以用alert()了!'); */

			function getAge () {
					var y = new Date().getFullYear();
					return y - this.birth;
				}
			var xiaoming = {
				name: '小明',
				age: getAge,
				birth: 1990,
				toJSON:function(){
					return{
						'Name':this.name,
						'Age':this.age(),
						'BirthDay':this.birth
					}
				}
			};

			//装饰器
			// 利用apply()，我们还可以动态改变函数的行为。
			//call不可用？？？可以用
			var count = 0;
			var old_getAge = getAge;

			window.getAge = function (){
                count++;
				return old_getAge.call(xiaoming);
			}

			//var age=xiaoming.age();
			var ageApply = getAge.apply(xiaoming,[]);
			var age = getAge.call(xiaoming);
			// alert('age'+age);
			// alert('count'+count);

			/*
			   高阶函数
			   map/reduce 
			*/
			// function product(arr) {
			// var retValue = arr.reduce(function(x,y)
			// 	{
			// 		return x*y;
			// 	});
			// return retValue;
			// }

			/* function string2int(s) {
				let strArray = [];
				for(let i =0 ;i<s.length;i++)
				{
					strArray[i] = s[i]-0;
				}

				//alert(strArray.length);
				return strArray.reduce(function(x,y)
				{
					return x*10+y*1;
				});
				//strArray = s.map(Math.abs);
			    // strArray = s.map(function (x){
				//    return x-'0';
				//    });
			}

			alert(string2int('12300')); */

			function normalize(arr) {
			    return arr.map(function(x)
				{
				   /* return x.reduce(function(a,b,idx)
				   {
					   if(idx===0)
						{
							return a.concat(b.toUpperCase());
						}
						else
						{
							return a.concat(b.toLowerCase());
						}

				   }); */
				   let retString  = "";
				   for(let i=0;i < x.length;i++)
				   {
					if(i===0)
					   {
						retString =retString.concat(x[i].toUpperCase());
					   }
					   else
					   {
						retString =retString.concat(x[i].toLowerCase());
					   }
				   }
				   return retString
				});
			}

			let norArr =  normalize(['adam', 'LISA', 'barT']);
			var arr = ['1', '2', '3'];
			var r;
			//r = arr.map(parseInt()); err
			r = arr.map(function(x){
				return parseInt(x,10);
			});
			alert('[' + r[0] + ', ' + r[1] + ', ' + r[2] + ']');

			// function sum(arr)
			//箭头函数
			var fn = (arr) =>{
				var fnSum = function(z){
						return arr.reduce(function(x,y)
						{
							return (x+y)*z;
						});
					}

				return fnSum;
			}
			
			/* var f = fn([1,2,3]);
			alert(f(1));
			var fib = (max) =>{
				var fnRet = function(){
					var t =0;
					var a = 0;
					var b = 1;
					var n = 2;
					var arr = [0,1];
					while(n<max)
					{
						t= a+b;
						a= b;
						b = t;
						arr.push(t);
						n++;
					}
					return arr;
				}
				return fnRet;
			}

			var fn2 = fib(10);
			var fn3 = fib(5);
			alert(fn2());
			alert(fn3()); */

			//function fib(max){
			/* var fib = (max) =>{
				var fnRet = function()
				{
					var t =0;
					var a = 0;
					var b = 1;
					var n = 2;
					var arr = [0,1];
					while(n<max)
					{
						t= a+b;
						a= b;
						b = t;
						arr.push(t);
						n++;
					}
					return arr;
				}
				return fnRet;
			}

			var f2 = fib(10);
			alert(f2()); */
			// alert(fib(10));


			/*
			* generator
			*
			*/
			/* function* fib(max)
			{
				var t =0;
				var a = 0;
				var b = 1;
				var n = 1;
				while(n<max){
					yield a;
					t= a+b;
					a= b;
					b = t;
					n++;
				}
				return a;
			}

			for(var x of fib(10))
			{
				alert(x);
			} */

			/* function* next_id() {
				var a=0;
				while(1==1)
				{
				a++;
				yield a;
				}
			}

			// 测试:
			var
				x,
				pass = true,
				g = next_id();
			for (x = 1; x < 100; x ++) {
				if (g.next().value !== x) {
					pass = false;
					alert('测试失败!');
					break;
				}
			}
			if (pass) {
				alert('测试通过!');
			} */


			//标准格式- Date
/* 			var now =new Date();
			alert(now);
			alert(new Date().getTime()); */

			//JSON
			//alert(JSON.stringify(xiaoming));

			let yahooApiString = '{"query":{"count":1,"created":"2016-10-16T05:32:32Z","lang":"en-US","results":{"channel":{"units":{"distance":"mi","pressure":"in","speed":"mph","temperature":"F"},"title":"Yahoo! Weather - Beijing, Beijing, CN","link":"http://us.rd.yahoo.com/dailynews/rss/weather/Country__Country/*https://weather.yahoo.com/country/state/city-2151330/","description":"Yahoo! Weather for Beijing, Beijing, CN","language":"en-us","lastBuildDate":"Sun, 16 Oct 2016 01:32 PM CST","ttl":"60","location":{"city":"Beijing","country":"China","region":" Beijing"},"wind":{"chill":"66","direction":"225","speed":"7"},"atmosphere":{"humidity":"65","pressure":"1013.0","rising":"0","visibility":"16.1"},"astronomy":{"sunrise":"6:27 am","sunset":"5:32 pm"},"image":{"title":"Yahoo! Weather","width":"142","height":"18","link":"http://weather.yahoo.com","url":"http://l.yimg.com/a/i/brand/purplelogo//uh/us/news-wea.gif"},"item":{"title":"Conditions for Beijing, Beijing, CN at 12:00 PM CST","lat":"39.90601","long":"116.387909","link":"http://us.rd.yahoo.com/dailynews/rss/weather/Country__Country/*https://weather.yahoo.com/country/state/city-2151330/","pubDate":"Sun, 16 Oct 2016 12:00 PM CST","condition":{"code":"28","date":"Sun, 16 Oct 2016 12:00 PM CST","temp":"65","text":"Mostly Cloudy"},"forecast":[{"code":"28","date":"16 Oct 2016","day":"Sun","high":"68","low":"53","text":"Mostly Cloudy"},{"code":"32","date":"17 Oct 2016","day":"Mon","high":"68","low":"51","text":"Sunny"},{"code":"32","date":"18 Oct 2016","day":"Tue","high":"68","low":"48","text":"Sunny"},{"code":"34","date":"19 Oct 2016","day":"Wed","high":"72","low":"51","text":"Mostly Sunny"},{"code":"28","date":"20 Oct 2016","day":"Thu","high":"64","low":"56","text":"Mostly Cloudy"},{"code":"26","date":"21 Oct 2016","day":"Fri","high":"61","low":"56","text":"Cloudy"},{"code":"28","date":"22 Oct 2016","day":"Sat","high":"58","low":"51","text":"Mostly Cloudy"},{"code":"30","date":"23 Oct 2016","day":"Sun","high":"56","low":"43","text":"Partly Cloudy"},{"code":"28","date":"24 Oct 2016","day":"Mon","high":"57","low":"42","text":"Mostly Cloudy"},{"code":"30","date":"25 Oct 2016","day":"Tue","high":"59","low":"47","text":"Partly Cloudy"}],"description":"<![CDATA[<img src=\\"http://l.yimg.com/a/i/us/we/52/28.gif\\"/>\\n<BR />\\n<b>Current Conditions:</b>\\n<BR />Mostly Cloudy\\n<BR />\\n<BR />\\n<b>Forecast:</b>\\n<BR /> Sun - Mostly Cloudy. High: 68Low: 53\\n<BR /> Mon - Sunny. High: 68Low: 51\\n<BR /> Tue - Sunny. High: 68Low: 48\\n<BR /> Wed - Mostly Sunny. High: 72Low: 51\\n<BR /> Thu - Mostly Cloudy. High: 64Low: 56\\n<BR />\\n<BR />\\n<a href=\\"http://us.rd.yahoo.com/dailynews/rss/weather/Country__Country/*https://weather.yahoo.com/country/state/city-2151330/\\">Full Forecast at Yahoo! Weather</a>\\n<BR />\\n<BR />\\n(provided by <a href=\\"http://www.weather.com\\" >The Weather Channel</a>)\\n<BR />\\n]]>","guid":{"isPermaLink":"false"}}}}}}';
			let jsonStr = JSON.parse(yahooApiString);
			// alert(JSON.stringify(jsonStr,null,'  '));

			//按照约定，构造函数首字母应当大写，而普通函数首字母应当小写，这样，一些语法检查工具如jslint将可以帮你检测到漏写的new。
			function Student(name)
			{
				this.name = name;
			}
			//如果我们通过new Student()创建了很多对象，这些对象的hello函数实际上只需要共享同一个函数就可以了，这样可以节省很多内存。
			// 要让创建的对象共享一个hello函数，根据对象的属性查找原则，我们只要把hello函数移动到xiaohong这些对象共同的原型上就可以了，也就是Student.prototype：
			Student.prototype.hello = function(){
				return 'hello '+this.name;
			}

			var xiaohong = new Student('xiaoH');
			alert(xiaohong.name);
			alert(xiaohong.hello());


/* var Duck = {
				name:'duck',
				fly:function(){
					alert(this.name+' is flying');
				}
			}

			function createDucks(name)
			{
				var s = Object.create(Duck);
				s.name = name;
				return s;
			}

			
			if(nDuck.__proto__  === Duck)
			{
				alert(nDuck.name+'is Duck');
			}
******************************改造为构造函************************************ */
			function Duck(props)
			{
				this.name = props.name;
				this.age = props.age;
				//this.fly = props.fly();
			}

			Duck.prototype.fly = function(){
				alert(this.name+' is flying'); 
			}

			function createDuck(props)
			{
				return new Duck(props||{});
			}

			var gagaDuck = createDuck(
				{
					name:'gagaDuck',
					age:2
				}
			);

			var kuekueDuck = createDuck(
				{
					name:'kuekueDuck',
					age:3
				}
			);

			gagaDuck.fly();
			kuekueDuck.fly();
			if(typeof gagaDuck.fly === 'function' && gagaDuck.fly === kuekueDuck.fly)
			{
				alert('Yes Done!!');
			}

 	    </script>
	</head>
    <body>
        <h1>Hello World</h1>
    </body>
</html>